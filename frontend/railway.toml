[build]
builder = "nixpacks"
buildCommand = "npm install && npm run build"

[deploy]
# Railway will serve the static files using Python's built-in server
startCommand = "sh -c 'cd dist && python3 -m http.server 5000'"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Environment variables for production
[deploy.environment]
VITE_API_BASE_URL = "https://wip-bitcoin-analytics-production.up.railway.app/api"
VITE_ENV = "production"

# Tell Railway to build from the frontend directory
[build.nixpacks]
root = "frontend"
